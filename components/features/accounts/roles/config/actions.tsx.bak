/**
 * UserRole Actions Configuration
 * 
 * Defines actions available for role management.
 */

import { Action } from '@/components/entityManager/components/actions/types';
import { UserRole } from '../types';
import { Plus, Edit, Trash2, Users, Power, PowerOff } from 'lucide-react';

export const roleActions: Action<UserRole>[] = [
  {
    id: 'create',
    type: 'navigation',
    label: 'Create Role',
    icon: <Plus className="h-4 w-4" />,
    variant: 'default',
    path: '/dashboard/roles/create',
    permissions: ['add_userrole'],
  },
  {
    id: 'edit',
    type: 'navigation',
    label: 'Edit',
    icon: <Edit className="h-4 w-4" />,
    variant: 'ghost',
    path: (role) => `/dashboard/roles/${role.id}/edit`,
    permissions: ['change_userrole'],
    visible: (role) => true,
  },
  {
    id: 'activate',
    type: 'confirm',
    label: 'Activate',
    icon: <Power className="h-4 w-4" />,
    variant: 'default',
    confirmTitle: 'Activate Role',
    confirmMessage: (role) => `Are you sure you want to activate the role '${role.display_name}'?`,
    confirmButton: 'Activate',
    onConfirm: async (role) => {
      // API call to activate role
      console.log('Activating role:', role.id);
    },
    permissions: ['change_userrole'],
    visible: (role) => !role.is_active,
  },
  {
    id: 'deactivate',
    type: 'confirm',
    label: 'Deactivate',
    icon: <PowerOff className="h-4 w-4" />,
    variant: 'secondary',
    confirmTitle: 'Deactivate Role',
    confirmMessage: (role) => `Are you sure you want to deactivate the role '${role.display_name}'? Users with this role will lose their permissions.`,
    confirmButton: 'Deactivate',
    confirmButtonVariant: 'destructive',
    onConfirm: async (role) => {
      // API call to deactivate role
      console.log('Deactivating role:', role.id);
    },
    permissions: ['change_userrole'],
    visible: (role) => role.is_active,
  },
  {
    id: 'assign',
    type: 'navigation',
    label: 'Assign to Users',
    icon: <Users className="h-4 w-4" />,
    variant: 'outline',
    path: (role) => `/dashboard/roles/${role.id}/assign`,
    permissions: ['change_userrole', 'change_user'],
    helpText: 'Assign this role to users',
  },
  {
    id: 'delete',
    type: 'confirm',
    label: 'Delete',
    icon: <Trash2 className="h-4 w-4" />,
    variant: 'destructive',
    confirmTitle: 'Delete Role',
    confirmMessage: (role) => `Are you sure you want to delete the role '${role.display_name}'? This action cannot be undone.`,
    confirmButton: 'Delete Role',
    confirmButtonVariant: 'destructive',
    onConfirm: async (role) => {
      // API call to delete role
      console.log('Deleting role:', role.id);
    },
    permissions: ['delete_userrole'],
    visible: (role) => (role.users_count || 0) === 0, // Only allow deletion if no users have this role
  },
];

export const roleBulkActions: Action<UserRole>[] = [
  {
    id: 'bulk_activate',
    type: 'bulk',
    label: 'Activate Selected',
    icon: Power,
    variant: 'default',
    onExecute: async (roles) => {
      console.log('Bulk activating roles:', roles.map(r => r.id));
    },
    permissions: ['change_userrole'],
  },
  {
    id: 'bulk_deactivate',
    type: 'bulk',
    label: 'Deactivate Selected',
    icon: PowerOff,
    variant: 'secondary',
    onExecute: async (roles) => {
      console.log('Bulk deactivating roles:', roles.map(r => r.id));
    },
    permissions: ['change_userrole'],
  },
  {
    id: 'bulk_delete',
    type: 'bulk',
    label: 'Delete Selected',
    icon: Trash2,
    variant: 'destructive',
    onExecute: async (roles) => {
      const roleIds = roles.map(r => r.id);
      console.log('Bulk deleting roles:', roleIds);
    },
    permissions: ['delete_userrole'],
  },
];
